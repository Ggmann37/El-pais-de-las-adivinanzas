<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C√≥digo Secreto | El pa√≠s de las adivinanzas</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 64 64%27%3E%3Ctext y=%2750%27 font-size=%2750%27%3E%F0%9F%93%9A%3C/text%3E%3C/svg%3E" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet" />
    <style>
      :root {
        --bg-1: #0f172a;
        --bg-2: #1e1b4b;
        --card: rgba(15, 23, 42, 0.8);
        --ok: #22c55e;
        --bad: #ef4444;
        --txt: #f8fafc;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: "Poppins", sans-serif;
        color: var(--txt);
        background: radial-gradient(circle at 20% 20%, #312e81, transparent 40%),
          radial-gradient(circle at 80% 80%, #0ea5e9, transparent 40%),
          linear-gradient(160deg, var(--bg-1), var(--bg-2));
        display: grid;
        place-items: center;
        overflow: hidden;
        padding: 1rem;
      }

      .github-link {
        position: fixed;
        top: 18px;
        right: 18px;
        width: 46px;
        height: 46px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        background: rgba(15, 23, 42, 0.75);
        border: 1px solid rgba(148, 163, 184, 0.35);
        color: #f8fafc;
        text-decoration: none;
        backdrop-filter: blur(8px);
        transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
      }

      .github-link:hover {
        transform: translateY(-2px) scale(1.03);
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.3);
        border-color: #22d3ee;
      }

      .timer {
        position: fixed;
        top: 18px;
        left: 18px;
        min-width: 150px;
        padding: 0.65rem 0.9rem;
        border-radius: 12px;
        border: 1px solid rgba(34, 211, 238, 0.4);
        background: rgba(15, 23, 42, 0.75);
        backdrop-filter: blur(8px);
        font-weight: 800;
        letter-spacing: 0.03em;
        text-align: center;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
      }

      .timer.done {
        border-color: rgba(34, 197, 94, 0.6);
        color: #86efac;
      }

      .glow {
        position: fixed;
        width: 380px;
        height: 380px;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0.25;
        animation: float 8s ease-in-out infinite;
      }

      .glow.one {
        background: #8b5cf6;
        top: -80px;
        left: -120px;
      }

      .glow.two {
        background: #22d3ee;
        right: -140px;
        bottom: -120px;
        animation-delay: 1.8s;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0) translateX(0);
        }
        50% {
          transform: translateY(-16px) translateX(12px);
        }
      }

      .card {
        width: min(92vw, 560px);
        padding: 2rem;
        border-radius: 24px;
        background: var(--card);
        border: 1px solid rgba(148, 163, 184, 0.25);
        backdrop-filter: blur(12px);
        box-shadow: 0 20px 55px rgba(0, 0, 0, 0.35);
        transform: translateY(8px);
        animation: entrance 700ms cubic-bezier(0.2, 0.65, 0.2, 1) forwards;
      }

      .start-screen {
        text-align: center;
      }

      .game-screen {
        display: none;
      }

      .game-screen.visible {
        display: block;
      }

      .start-btn {
        padding: 1rem 1.6rem;
        font-size: 1.05rem;
      }

      @keyframes entrance {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      h1 {
        margin: 0 0 0.7rem;
        font-size: clamp(1.6rem, 3vw, 2.1rem);
        line-height: 1.2;
      }

      p {
        margin: 0 0 1.2rem;
        color: #cbd5e1;
      }

      .input-wrap {
        display: flex;
        gap: 0.7rem;
      }

      input {
        width: 100%;
        padding: 0.9rem 1rem;
        border-radius: 12px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(15, 23, 42, 0.85);
        color: white;
        outline: none;
        transition: border-color 0.2s ease, transform 0.2s ease;
        font-family: inherit;
      }

      input:focus {
        border-color: #22d3ee;
        transform: translateY(-1px);
      }

      button {
        border: none;
        border-radius: 12px;
        padding: 0.9rem 1.2rem;
        font-weight: 700;
        color: white;
        background: linear-gradient(90deg, #22d3ee, #6366f1);
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      button:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 10px 30px rgba(34, 211, 238, 0.25);
      }

      #status {
        margin-top: 0.9rem;
        min-height: 1.4rem;
        font-weight: 600;
      }

      .incorrect {
        color: var(--bad);
        animation: shake 280ms linear 2;
      }

      @keyframes shake {
        25% {
          transform: translateX(-6px);
        }
        75% {
          transform: translateX(6px);
        }
      }

      .success-panel {
        margin-top: 1.1rem;
        padding: 1rem;
        border-radius: 16px;
        border: 1px solid rgba(34, 197, 94, 0.4);
        background: rgba(34, 197, 94, 0.1);
        display: none;
      }

      .success-panel.visible {
        display: block;
        animation: pop 500ms ease;
      }

      @keyframes pop {
        0% {
          transform: scale(0.85);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .success-title {
        font-size: 1.4rem;
        font-weight: 800;
        margin: 0 0 0.8rem;
        color: #86efac;
      }
    </style>
  </head>
  <body>
    <a
      class="github-link"
      href="https://github.com/search?q=El-pais-de-las-adivinanzas&type=repositories"
      target="_blank"
      rel="noopener noreferrer"
      title="Ver repositorio en GitHub (solo lectura)"
      aria-label="Ver repositorio en GitHub"
    >
      <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path
          d="M12 2C6.477 2 2 6.486 2 12.018c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.009-.866-.014-1.699-2.782.605-3.369-1.344-3.369-1.344-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.004.071 1.532 1.033 1.532 1.033.892 1.53 2.341 1.088 2.91.832.091-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0 1 12 6.844a9.56 9.56 0 0 1 2.504.337c1.909-1.296 2.747-1.026 2.747-1.026.546 1.378.203 2.397.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.31.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.481A10.02 10.02 0 0 0 22 12.018C22 6.486 17.523 2 12 2Z"
        ></path>
      </svg>
    </a>

    <div id="timer" class="timer">‚è±Ô∏è 00:00</div>

    <div class="glow one"></div>
    <div class="glow two"></div>

    <main class="card">
      <section id="startScreen" class="start-screen">
        <h1>Empezar juego</h1>
        <p>Pulsa el bot√≥n para comenzar el reto.</p>
        <button id="startBtn" class="start-btn" type="button">Empezar juego</button>
      </section>

      <section id="gameScreen" class="game-screen">
        <h1>Introduce el c√≥digo secreto</h1>
        <p>Introduce c√≥digo secreto.</p>

        <div class="input-wrap">
          <input id="codeInput" type="text" placeholder="Escribe el c√≥digo..." autocomplete="off" />
          <button id="checkBtn" type="button">Comprobar</button>
        </div>

        <div id="status"></div>

        <section id="successPanel" class="success-panel">
          <h2 class="success-title">üéâ ¬°Has ganado!</h2>
          <p id="timeResult">Tiempo: 00:00</p>
          <button id="diplomaBtn" type="button">Crear diploma PDF</button>
        </section>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script>
      const startScreen = document.getElementById("startScreen");
      const gameScreen = document.getElementById("gameScreen");
      const startBtn = document.getElementById("startBtn");
      const input = document.getElementById("codeInput");
      const checkBtn = document.getElementById("checkBtn");
      const status = document.getElementById("status");
      const timer = document.getElementById("timer");
      const timeResult = document.getElementById("timeResult");
      const successPanel = document.getElementById("successPanel");
      const diplomaBtn = document.getElementById("diplomaBtn");

      const CORRECT_CODE = "erectus";
      let startTime = null;
      let timerInterval = null;
      let finalTimeText = "00:00";

      function formatSeconds(totalSeconds) {
        const minutes = Math.floor(totalSeconds / 60)
          .toString()
          .padStart(2, "0");
        const seconds = Math.floor(totalSeconds % 60)
          .toString()
          .padStart(2, "0");
        return `${minutes}:${seconds}`;
      }

      function startTimer() {
        startTime = Date.now();
        timer.classList.remove("done");
        timer.textContent = "‚è±Ô∏è 00:00";

        timerInterval = window.setInterval(() => {
          const elapsed = Math.floor((Date.now() - startTime) / 1000);
          timer.textContent = `‚è±Ô∏è ${formatSeconds(elapsed)}`;
        }, 250);
      }

      function stopTimer() {
        if (timerInterval) {
          window.clearInterval(timerInterval);
          timerInterval = null;
        }
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        finalTimeText = formatSeconds(elapsed);
        timer.textContent = `‚è±Ô∏è ${finalTimeText}`;
        timer.classList.add("done");
        timeResult.textContent = `Tiempo: ${finalTimeText}`;
      }

      function validateCode() {
        const value = input.value.trim().toLowerCase();

        if (value === CORRECT_CODE) {
          status.textContent = "‚úÖ Correcto";
          status.className = "";
          status.style.color = "#22c55e";
          stopTimer();
          successPanel.classList.add("visible");
        } else {
          status.textContent = "‚ùå Incorrecto";
          status.className = "incorrect";
          status.style.color = "";
          successPanel.classList.remove("visible");
        }
      }

      startBtn.addEventListener("click", () => {
        startScreen.style.display = "none";
        gameScreen.classList.add("visible");
        input.focus();
        startTimer();
      });

      checkBtn.addEventListener("click", validateCode);
      input.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          validateCode();
        }
      });

      diplomaBtn.addEventListener("click", () => {
        const nombre = window.prompt("Introduce tu nombre para el diploma:", "");

        if (nombre === null) {
          return;
        }

        const nombreLimpio = nombre.trim();

        if (!nombreLimpio) {
          window.alert("Debes introducir un nombre para generar el diploma.");
          return;
        }

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        doc.setFillColor(15, 23, 42);
        doc.rect(0, 0, 210, 297, "F");

        doc.setTextColor(255, 255, 255);
        doc.setFont("helvetica", "bold");
        doc.setFontSize(28);
        doc.text("Diploma de logro", 105, 70, { align: "center" });

        doc.setFont("helvetica", "normal");
        doc.setFontSize(18);
        doc.text(`Felicidades ${nombreLimpio}, lo has conseguido.`, 105, 120, { align: "center" });

        doc.setFontSize(14);
        doc.text(`Tiempo final: ${finalTimeText}`, 105, 138, { align: "center" });

        doc.setFontSize(12);
        doc.setTextColor(148, 163, 184);
        doc.text("El pa√≠s de las adivinanzas", 105, 156, { align: "center" });

        doc.save(`diploma-${nombreLimpio.replace(/\s+/g, "-").toLowerCase()}.pdf`);
      });
    </script>
  </body>
</html>
